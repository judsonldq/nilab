Job start...
2019-01-22 10:09:21.402014: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-01-22 10:09:21.482949: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-01-22 10:09:21.483279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.683
pciBusID: 0000:01:00.0
totalMemory: 10.91GiB freeMemory: 9.99GiB
2019-01-22 10:09:21.483291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0
2019-01-22 10:09:21.588083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-01-22 10:09:21.588120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 
2019-01-22 10:09:21.588127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N 
2019-01-22 10:09:21.588257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9661 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 8s - loss: 0.3727 - acc: 0.9023 - val_loss: 0.2047 - val_acc: 0.9524
Epoch 2/50
 - 5s - loss: 0.2297 - acc: 0.9377 - val_loss: 0.2844 - val_acc: 0.9428
Epoch 3/50
 - 5s - loss: 0.2020 - acc: 0.9451 - val_loss: 0.2249 - val_acc: 0.9334
Epoch 4/50
 - 5s - loss: 0.1957 - acc: 0.9494 - val_loss: 0.1917 - val_acc: 0.9434
Epoch 5/50
 - 5s - loss: 0.1875 - acc: 0.9497 - val_loss: 0.1713 - val_acc: 0.9544
Epoch 6/50
 - 5s - loss: 0.1669 - acc: 0.9547 - val_loss: 0.1515 - val_acc: 0.9644
Epoch 7/50
 - 5s - loss: 0.1634 - acc: 0.9550 - val_loss: 0.2473 - val_acc: 0.9320
Epoch 8/50
 - 5s - loss: 0.1550 - acc: 0.9588 - val_loss: 0.2557 - val_acc: 0.9518
Epoch 9/50
 - 5s - loss: 0.1448 - acc: 0.9619 - val_loss: 0.2545 - val_acc: 0.9034
Epoch 10/50
 - 5s - loss: 0.1364 - acc: 0.9650 - val_loss: 0.1977 - val_acc: 0.9628
Epoch 00010: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 8s - loss: 0.3740 - acc: 0.9042 - val_loss: 0.9356 - val_acc: 0.8902
Epoch 2/50
 - 5s - loss: 0.2336 - acc: 0.9371 - val_loss: 0.2047 - val_acc: 0.9498
Epoch 3/50
 - 5s - loss: 0.2014 - acc: 0.9441 - val_loss: 0.1841 - val_acc: 0.9592
Epoch 4/50
 - 5s - loss: 0.1853 - acc: 0.9485 - val_loss: 0.2462 - val_acc: 0.9468
Epoch 5/50
 - 5s - loss: 0.1647 - acc: 0.9565 - val_loss: 0.1665 - val_acc: 0.9634
Epoch 6/50
 - 5s - loss: 0.1538 - acc: 0.9579 - val_loss: 0.2051 - val_acc: 0.9484
Epoch 7/50
 - 5s - loss: 0.1477 - acc: 0.9604 - val_loss: 0.3449 - val_acc: 0.9128
Epoch 8/50
 - 5s - loss: 0.1466 - acc: 0.9604 - val_loss: 0.2004 - val_acc: 0.9564
Epoch 9/50
 - 5s - loss: 0.1391 - acc: 0.9629 - val_loss: 0.1707 - val_acc: 0.9570
Epoch 00009: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 8s - loss: 0.3524 - acc: 0.9091 - val_loss: 0.2491 - val_acc: 0.9442
Epoch 2/50
 - 5s - loss: 0.2137 - acc: 0.9427 - val_loss: 0.2001 - val_acc: 0.9448
Epoch 3/50
 - 5s - loss: 0.1884 - acc: 0.9495 - val_loss: 0.2061 - val_acc: 0.9658
Epoch 4/50
 - 5s - loss: 0.1705 - acc: 0.9555 - val_loss: 0.1442 - val_acc: 0.9680
Epoch 5/50
 - 5s - loss: 0.1682 - acc: 0.9583 - val_loss: 0.1873 - val_acc: 0.9506
Epoch 6/50
 - 5s - loss: 0.1638 - acc: 0.9562 - val_loss: 0.1671 - val_acc: 0.9588
Epoch 7/50
 - 5s - loss: 0.1550 - acc: 0.9607 - val_loss: 0.1619 - val_acc: 0.9614
Epoch 8/50
 - 5s - loss: 0.1512 - acc: 0.9602 - val_loss: 0.1629 - val_acc: 0.9574
Epoch 00008: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 8s - loss: 0.3689 - acc: 0.9075 - val_loss: 0.4319 - val_acc: 0.9308
Epoch 2/50
 - 5s - loss: 0.2128 - acc: 0.9425 - val_loss: 0.2469 - val_acc: 0.9376
Epoch 3/50
 - 5s - loss: 0.1937 - acc: 0.9491 - val_loss: 0.1632 - val_acc: 0.9644
Epoch 4/50
 - 5s - loss: 0.1718 - acc: 0.9560 - val_loss: 0.1411 - val_acc: 0.9666
Epoch 5/50
 - 5s - loss: 0.1549 - acc: 0.9607 - val_loss: 0.1895 - val_acc: 0.9520
Epoch 6/50
 - 5s - loss: 0.1507 - acc: 0.9630 - val_loss: 0.2375 - val_acc: 0.9526
Epoch 7/50
 - 5s - loss: 0.1425 - acc: 0.9642 - val_loss: 0.1401 - val_acc: 0.9664
Epoch 8/50
 - 5s - loss: 0.1455 - acc: 0.9607 - val_loss: 0.1418 - val_acc: 0.9686
Epoch 00008: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 9s - loss: 0.3639 - acc: 0.9075 - val_loss: 0.2774 - val_acc: 0.9312
Epoch 2/50
 - 5s - loss: 0.2188 - acc: 0.9425 - val_loss: 0.1917 - val_acc: 0.9570
Epoch 3/50
 - 5s - loss: 0.1979 - acc: 0.9482 - val_loss: 0.1638 - val_acc: 0.9606
Epoch 4/50
 - 5s - loss: 0.1800 - acc: 0.9519 - val_loss: 0.1502 - val_acc: 0.9674
Epoch 5/50
 - 5s - loss: 0.1647 - acc: 0.9580 - val_loss: 0.1865 - val_acc: 0.9514
Epoch 6/50
 - 5s - loss: 0.1529 - acc: 0.9592 - val_loss: 0.3923 - val_acc: 0.9328
Epoch 7/50
 - 5s - loss: 0.1523 - acc: 0.9600 - val_loss: 0.1348 - val_acc: 0.9712
Epoch 8/50
 - 5s - loss: 0.1440 - acc: 0.9612 - val_loss: 0.1520 - val_acc: 0.9648
Epoch 9/50
 - 5s - loss: 0.1457 - acc: 0.9630 - val_loss: 0.1319 - val_acc: 0.9710
Epoch 10/50
 - 5s - loss: 0.1456 - acc: 0.9600 - val_loss: 0.1318 - val_acc: 0.9698
Epoch 11/50
 - 5s - loss: 0.1400 - acc: 0.9646 - val_loss: 0.1586 - val_acc: 0.9566
Epoch 12/50
 - 5s - loss: 0.1309 - acc: 0.9660 - val_loss: 0.1600 - val_acc: 0.9628
Epoch 13/50
 - 5s - loss: 0.1281 - acc: 0.9666 - val_loss: 0.1389 - val_acc: 0.9672
Epoch 00013: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 9s - loss: 0.3682 - acc: 0.9022 - val_loss: 0.2029 - val_acc: 0.9546
Epoch 2/50
 - 5s - loss: 0.2136 - acc: 0.9441 - val_loss: 0.1942 - val_acc: 0.9470
Epoch 3/50
 - 5s - loss: 0.1845 - acc: 0.9513 - val_loss: 0.2754 - val_acc: 0.9398
Epoch 4/50
 - 5s - loss: 0.1759 - acc: 0.9536 - val_loss: 0.1726 - val_acc: 0.9596
Epoch 5/50
 - 5s - loss: 0.1540 - acc: 0.9578 - val_loss: 0.2323 - val_acc: 0.9522
Epoch 6/50
 - 5s - loss: 0.1528 - acc: 0.9601 - val_loss: 0.1606 - val_acc: 0.9656
Epoch 7/50
 - 5s - loss: 0.1458 - acc: 0.9627 - val_loss: 0.1572 - val_acc: 0.9656
Epoch 8/50
 - 5s - loss: 0.1423 - acc: 0.9632 - val_loss: 0.2179 - val_acc: 0.9540
Epoch 9/50
 - 5s - loss: 0.1358 - acc: 0.9657 - val_loss: 0.1710 - val_acc: 0.9566
Epoch 10/50
 - 5s - loss: 0.1378 - acc: 0.9635 - val_loss: 0.1504 - val_acc: 0.9646
Epoch 11/50
 - 5s - loss: 0.1318 - acc: 0.9656 - val_loss: 1.3449 - val_acc: 0.9124
Epoch 12/50
 - 5s - loss: 0.1278 - acc: 0.9669 - val_loss: 0.1475 - val_acc: 0.9674
Epoch 13/50
 - 5s - loss: 0.1258 - acc: 0.9680 - val_loss: 0.1284 - val_acc: 0.9672
Epoch 14/50
 - 5s - loss: 0.1207 - acc: 0.9688 - val_loss: 0.1790 - val_acc: 0.9606
Epoch 15/50
 - 5s - loss: 0.1194 - acc: 0.9693 - val_loss: 0.2665 - val_acc: 0.9418
Epoch 16/50
 - 5s - loss: 0.1209 - acc: 0.9702 - val_loss: 0.1508 - val_acc: 0.9670
Epoch 17/50
 - 5s - loss: 0.1173 - acc: 0.9686 - val_loss: 0.3264 - val_acc: 0.9540
Epoch 00017: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 10s - loss: 0.3648 - acc: 0.9036 - val_loss: 0.2100 - val_acc: 0.9542
Epoch 2/50
 - 5s - loss: 0.2254 - acc: 0.9363 - val_loss: 0.1991 - val_acc: 0.9554
Epoch 3/50
 - 5s - loss: 0.1933 - acc: 0.9453 - val_loss: 0.2157 - val_acc: 0.9458
Epoch 4/50
 - 5s - loss: 0.1765 - acc: 0.9528 - val_loss: 0.1721 - val_acc: 0.9590
Epoch 5/50
 - 5s - loss: 0.1670 - acc: 0.9547 - val_loss: 1.0651 - val_acc: 0.8354
Epoch 6/50
 - 5s - loss: 0.1578 - acc: 0.9580 - val_loss: 0.2837 - val_acc: 0.9262
Epoch 7/50
 - 5s - loss: 0.1530 - acc: 0.9598 - val_loss: 0.1487 - val_acc: 0.9682
Epoch 8/50
 - 5s - loss: 0.1429 - acc: 0.9635 - val_loss: 0.1737 - val_acc: 0.9562
Epoch 9/50
 - 5s - loss: 0.1465 - acc: 0.9624 - val_loss: 0.1859 - val_acc: 0.9664
Epoch 10/50
 - 5s - loss: 0.1395 - acc: 0.9650 - val_loss: 0.1630 - val_acc: 0.9630
Epoch 11/50
 - 5s - loss: 0.1341 - acc: 0.9654 - val_loss: 0.2582 - val_acc: 0.9176
Epoch 00011: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 10s - loss: 0.3583 - acc: 0.9085 - val_loss: 0.4503 - val_acc: 0.9174
Epoch 2/50
 - 5s - loss: 0.2268 - acc: 0.9370 - val_loss: 0.1684 - val_acc: 0.9616
Epoch 3/50
 - 5s - loss: 0.2005 - acc: 0.9448 - val_loss: 0.1958 - val_acc: 0.9582
Epoch 4/50
 - 5s - loss: 0.1821 - acc: 0.9495 - val_loss: 0.2401 - val_acc: 0.9522
Epoch 5/50
 - 5s - loss: 0.1651 - acc: 0.9542 - val_loss: 0.1575 - val_acc: 0.9646
Epoch 6/50
 - 5s - loss: 0.1589 - acc: 0.9584 - val_loss: 0.1680 - val_acc: 0.9612
Epoch 7/50
 - 5s - loss: 0.1460 - acc: 0.9633 - val_loss: 0.1637 - val_acc: 0.9612
Epoch 8/50
 - 5s - loss: 0.1482 - acc: 0.9609 - val_loss: 0.1469 - val_acc: 0.9632
Epoch 9/50
 - 5s - loss: 0.1447 - acc: 0.9611 - val_loss: 0.1973 - val_acc: 0.9576
Epoch 10/50
 - 5s - loss: 0.1385 - acc: 0.9636 - val_loss: 0.1492 - val_acc: 0.9678
Epoch 11/50
 - 5s - loss: 0.1355 - acc: 0.9651 - val_loss: 0.1731 - val_acc: 0.9518
Epoch 12/50
 - 5s - loss: 0.1367 - acc: 0.9645 - val_loss: 0.1340 - val_acc: 0.9660
Epoch 13/50
 - 5s - loss: 0.1310 - acc: 0.9660 - val_loss: 0.1799 - val_acc: 0.9616
Epoch 14/50
 - 5s - loss: 0.1227 - acc: 0.9690 - val_loss: 0.1900 - val_acc: 0.9482
Epoch 15/50
 - 5s - loss: 0.1223 - acc: 0.9673 - val_loss: 0.1354 - val_acc: 0.9666
Epoch 16/50
 - 5s - loss: 0.1244 - acc: 0.9692 - val_loss: 0.2113 - val_acc: 0.9498
Epoch 00016: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 10s - loss: 0.3666 - acc: 0.9039 - val_loss: 0.1787 - val_acc: 0.9594
Epoch 2/50
 - 5s - loss: 0.2247 - acc: 0.9408 - val_loss: 0.1914 - val_acc: 0.9548
Epoch 3/50
 - 5s - loss: 0.1833 - acc: 0.9524 - val_loss: 0.1559 - val_acc: 0.9636
Epoch 4/50
 - 5s - loss: 0.1845 - acc: 0.9507 - val_loss: 0.2127 - val_acc: 0.9548
Epoch 5/50
 - 5s - loss: 0.1676 - acc: 0.9551 - val_loss: 0.1454 - val_acc: 0.9664
Epoch 6/50
 - 5s - loss: 0.1618 - acc: 0.9554 - val_loss: 0.1294 - val_acc: 0.9696
Epoch 7/50
 - 5s - loss: 0.1565 - acc: 0.9595 - val_loss: 0.1709 - val_acc: 0.9640
Epoch 8/50
 - 5s - loss: 0.1515 - acc: 0.9578 - val_loss: 0.1598 - val_acc: 0.9648
Epoch 9/50
 - 5s - loss: 0.1399 - acc: 0.9651 - val_loss: 0.1649 - val_acc: 0.9574
Epoch 10/50
 - 5s - loss: 0.1446 - acc: 0.9627 - val_loss: 0.1255 - val_acc: 0.9702
Epoch 11/50
 - 6s - loss: 0.1349 - acc: 0.9639 - val_loss: 0.2091 - val_acc: 0.9596
Epoch 12/50
 - 5s - loss: 0.1327 - acc: 0.9643 - val_loss: 0.1931 - val_acc: 0.9618
Epoch 13/50
 - 5s - loss: 0.1266 - acc: 0.9670 - val_loss: 0.1566 - val_acc: 0.9598
Epoch 14/50
 - 5s - loss: 0.1262 - acc: 0.9666 - val_loss: 0.3605 - val_acc: 0.9136
Epoch 00014: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 11s - loss: 0.3620 - acc: 0.9085 - val_loss: 0.2114 - val_acc: 0.9578
Epoch 2/50
 - 5s - loss: 0.2277 - acc: 0.9364 - val_loss: 0.2468 - val_acc: 0.9368
Epoch 3/50
 - 5s - loss: 0.1977 - acc: 0.9462 - val_loss: 0.1779 - val_acc: 0.9618
Epoch 4/50
 - 5s - loss: 0.1790 - acc: 0.9519 - val_loss: 0.2263 - val_acc: 0.9544
Epoch 5/50
 - 5s - loss: 0.1692 - acc: 0.9533 - val_loss: 0.1867 - val_acc: 0.9600
Epoch 6/50
 - 5s - loss: 0.1627 - acc: 0.9555 - val_loss: 0.4721 - val_acc: 0.9358
Epoch 7/50
 - 5s - loss: 0.1504 - acc: 0.9576 - val_loss: 0.1486 - val_acc: 0.9616
Epoch 8/50
 - 5s - loss: 0.1394 - acc: 0.9634 - val_loss: 0.1389 - val_acc: 0.9692
Epoch 9/50
 - 6s - loss: 0.1464 - acc: 0.9619 - val_loss: 0.1932 - val_acc: 0.9508
Epoch 10/50
 - 5s - loss: 0.1475 - acc: 0.9611 - val_loss: 0.2098 - val_acc: 0.9388
Epoch 11/50
 - 5s - loss: 0.1390 - acc: 0.9649 - val_loss: 0.2142 - val_acc: 0.9468
Epoch 12/50
 - 5s - loss: 0.1357 - acc: 0.9634 - val_loss: 0.1732 - val_acc: 0.9618
Epoch 00012: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 11s - loss: 0.3743 - acc: 0.9028 - val_loss: 0.2122 - val_acc: 0.9504
Epoch 2/50
 - 6s - loss: 0.2304 - acc: 0.9357 - val_loss: 0.1991 - val_acc: 0.9534
Epoch 3/50
 - 5s - loss: 0.1964 - acc: 0.9469 - val_loss: 0.1517 - val_acc: 0.9632
Epoch 4/50
 - 6s - loss: 0.1874 - acc: 0.9501 - val_loss: 0.1976 - val_acc: 0.9538
Epoch 5/50
 - 5s - loss: 0.1724 - acc: 0.9549 - val_loss: 0.2296 - val_acc: 0.9630
Epoch 6/50
 - 6s - loss: 0.1647 - acc: 0.9568 - val_loss: 0.1480 - val_acc: 0.9618
Epoch 7/50
 - 6s - loss: 0.1594 - acc: 0.9595 - val_loss: 0.1455 - val_acc: 0.9700
Epoch 8/50
 - 6s - loss: 0.1486 - acc: 0.9608 - val_loss: 0.1448 - val_acc: 0.9668
Epoch 9/50
 - 6s - loss: 0.1430 - acc: 0.9629 - val_loss: 0.1391 - val_acc: 0.9684
Epoch 10/50
 - 6s - loss: 0.1369 - acc: 0.9653 - val_loss: 0.1442 - val_acc: 0.9710
Epoch 11/50
 - 5s - loss: 0.1280 - acc: 0.9675 - val_loss: 0.1399 - val_acc: 0.9676
Epoch 12/50
 - 6s - loss: 0.1282 - acc: 0.9662 - val_loss: 0.1596 - val_acc: 0.9638
Epoch 13/50
 - 5s - loss: 0.1221 - acc: 0.9682 - val_loss: 0.3749 - val_acc: 0.9376
Epoch 00013: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 12s - loss: 0.3590 - acc: 0.9113 - val_loss: 0.2098 - val_acc: 0.9474
Epoch 2/50
 - 6s - loss: 0.2273 - acc: 0.9367 - val_loss: 0.2229 - val_acc: 0.9384
Epoch 3/50
 - 6s - loss: 0.1920 - acc: 0.9484 - val_loss: 0.2344 - val_acc: 0.9498
Epoch 4/50
 - 6s - loss: 0.1767 - acc: 0.9543 - val_loss: 0.1607 - val_acc: 0.9598
Epoch 5/50
 - 6s - loss: 0.1658 - acc: 0.9568 - val_loss: 0.1779 - val_acc: 0.9540
Epoch 6/50
 - 6s - loss: 0.1559 - acc: 0.9603 - val_loss: 0.2629 - val_acc: 0.9504
Epoch 7/50
 - 6s - loss: 0.1483 - acc: 0.9620 - val_loss: 0.1559 - val_acc: 0.9556
Epoch 8/50
 - 6s - loss: 0.1491 - acc: 0.9596 - val_loss: 0.1893 - val_acc: 0.9550
Epoch 00008: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 12s - loss: 0.3658 - acc: 0.9053 - val_loss: 0.1852 - val_acc: 0.9578
Epoch 2/50
 - 6s - loss: 0.2252 - acc: 0.9375 - val_loss: 0.1928 - val_acc: 0.9488
Epoch 3/50
 - 6s - loss: 0.1972 - acc: 0.9477 - val_loss: 0.1928 - val_acc: 0.9610
Epoch 4/50
 - 6s - loss: 0.1839 - acc: 0.9509 - val_loss: 0.1455 - val_acc: 0.9660
Epoch 5/50
 - 6s - loss: 0.1716 - acc: 0.9539 - val_loss: 0.1802 - val_acc: 0.9570
Epoch 6/50
 - 6s - loss: 0.1663 - acc: 0.9572 - val_loss: 0.1640 - val_acc: 0.9622
Epoch 7/50
 - 6s - loss: 0.1589 - acc: 0.9578 - val_loss: 0.2088 - val_acc: 0.9512
Epoch 8/50
 - 5s - loss: 0.1513 - acc: 0.9615 - val_loss: 0.1681 - val_acc: 0.9624
Epoch 00008: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 12s - loss: 0.3678 - acc: 0.9082 - val_loss: 0.2089 - val_acc: 0.9544
Epoch 2/50
 - 5s - loss: 0.2210 - acc: 0.9411 - val_loss: 0.1677 - val_acc: 0.9626
Epoch 3/50
 - 5s - loss: 0.1936 - acc: 0.9467 - val_loss: 1.1493 - val_acc: 0.8662
Epoch 4/50
 - 5s - loss: 0.1774 - acc: 0.9524 - val_loss: 0.1710 - val_acc: 0.9620
Epoch 5/50
 - 5s - loss: 0.1736 - acc: 0.9541 - val_loss: 0.1629 - val_acc: 0.9622
Epoch 6/50
 - 5s - loss: 0.1580 - acc: 0.9587 - val_loss: 0.1892 - val_acc: 0.9562
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 12s - loss: 0.3632 - acc: 0.9069 - val_loss: 0.2510 - val_acc: 0.9520
Epoch 2/50
 - 5s - loss: 0.2280 - acc: 0.9375 - val_loss: 0.2353 - val_acc: 0.9506
Epoch 3/50
 - 5s - loss: 0.2046 - acc: 0.9452 - val_loss: 0.2048 - val_acc: 0.9606
Epoch 4/50
 - 5s - loss: 0.1768 - acc: 0.9534 - val_loss: 0.2080 - val_acc: 0.9510
Epoch 5/50
 - 5s - loss: 0.1740 - acc: 0.9519 - val_loss: 0.1683 - val_acc: 0.9596
Epoch 6/50
 - 5s - loss: 0.1593 - acc: 0.9549 - val_loss: 3.1045 - val_acc: 0.7106
Epoch 7/50
 - 5s - loss: 0.1556 - acc: 0.9574 - val_loss: 0.2461 - val_acc: 0.9266
Epoch 8/50
 - 5s - loss: 0.1432 - acc: 0.9612 - val_loss: 0.1451 - val_acc: 0.9632
Epoch 9/50
 - 5s - loss: 0.1405 - acc: 0.9616 - val_loss: 0.1653 - val_acc: 0.9520
Epoch 10/50
 - 5s - loss: 0.1355 - acc: 0.9637 - val_loss: 0.1610 - val_acc: 0.9642
Epoch 11/50
 - 5s - loss: 0.1421 - acc: 0.9621 - val_loss: 0.2075 - val_acc: 0.9540
Epoch 12/50
 - 5s - loss: 0.1330 - acc: 0.9637 - val_loss: 0.1644 - val_acc: 0.9596
Epoch 00012: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 12s - loss: 0.3545 - acc: 0.9092 - val_loss: 0.2084 - val_acc: 0.9520
Epoch 2/50
 - 5s - loss: 0.2157 - acc: 0.9432 - val_loss: 0.2119 - val_acc: 0.9454
Epoch 3/50
 - 5s - loss: 0.1763 - acc: 0.9555 - val_loss: 0.2171 - val_acc: 0.9504
Epoch 4/50
 - 5s - loss: 0.1651 - acc: 0.9577 - val_loss: 0.1413 - val_acc: 0.9654
Epoch 5/50
 - 5s - loss: 0.1540 - acc: 0.9593 - val_loss: 0.1530 - val_acc: 0.9670
Epoch 6/50
 - 5s - loss: 0.1438 - acc: 0.9633 - val_loss: 0.1629 - val_acc: 0.9614
Epoch 7/50
 - 5s - loss: 0.1429 - acc: 0.9625 - val_loss: 0.1653 - val_acc: 0.9542
Epoch 8/50
 - 5s - loss: 0.1335 - acc: 0.9665 - val_loss: 0.1626 - val_acc: 0.9552
Epoch 00008: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 13s - loss: 0.3769 - acc: 0.9034 - val_loss: 0.2022 - val_acc: 0.9544
Epoch 2/50
 - 5s - loss: 0.2285 - acc: 0.9382 - val_loss: 0.2546 - val_acc: 0.9524
Epoch 3/50
 - 5s - loss: 0.1877 - acc: 0.9504 - val_loss: 0.2370 - val_acc: 0.9410
Epoch 4/50
 - 5s - loss: 0.1886 - acc: 0.9482 - val_loss: 0.2133 - val_acc: 0.9560
Epoch 5/50
 - 5s - loss: 0.1640 - acc: 0.9558 - val_loss: 0.2031 - val_acc: 0.9484
Epoch 00005: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 13s - loss: 0.3651 - acc: 0.9066 - val_loss: 0.1906 - val_acc: 0.9598
Epoch 2/50
 - 5s - loss: 0.2275 - acc: 0.9361 - val_loss: 0.1669 - val_acc: 0.9582
Epoch 3/50
 - 5s - loss: 0.1998 - acc: 0.9476 - val_loss: 0.1747 - val_acc: 0.9538
Epoch 4/50
 - 5s - loss: 0.1802 - acc: 0.9519 - val_loss: 0.1676 - val_acc: 0.9624
Epoch 5/50
 - 6s - loss: 0.1756 - acc: 0.9530 - val_loss: 0.1856 - val_acc: 0.9612
Epoch 6/50
 - 5s - loss: 0.1655 - acc: 0.9564 - val_loss: 0.1733 - val_acc: 0.9646
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 14s - loss: 0.3617 - acc: 0.9064 - val_loss: 0.2611 - val_acc: 0.9362
Epoch 2/50
 - 5s - loss: 0.2155 - acc: 0.9428 - val_loss: 0.1642 - val_acc: 0.9610
Epoch 3/50
 - 5s - loss: 0.1894 - acc: 0.9494 - val_loss: 0.1329 - val_acc: 0.9722
Epoch 4/50
 - 5s - loss: 0.1673 - acc: 0.9563 - val_loss: 0.1693 - val_acc: 0.9616
Epoch 5/50
 - 5s - loss: 0.1554 - acc: 0.9606 - val_loss: 0.1687 - val_acc: 0.9640
Epoch 6/50
 - 5s - loss: 0.1496 - acc: 0.9611 - val_loss: 0.2019 - val_acc: 0.9478
Epoch 7/50
 - 5s - loss: 0.1440 - acc: 0.9631 - val_loss: 0.2070 - val_acc: 0.9420
Epoch 00007: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 14s - loss: 0.3647 - acc: 0.9045 - val_loss: 0.2275 - val_acc: 0.9358
Epoch 2/50
 - 5s - loss: 0.2314 - acc: 0.9353 - val_loss: 0.2102 - val_acc: 0.9452
Epoch 3/50
 - 5s - loss: 0.2049 - acc: 0.9455 - val_loss: 0.1692 - val_acc: 0.9598
Epoch 4/50
 - 5s - loss: 0.1962 - acc: 0.9467 - val_loss: 1.1681 - val_acc: 0.8550
Epoch 5/50
 - 6s - loss: 0.1806 - acc: 0.9519 - val_loss: 0.1566 - val_acc: 0.9652
Epoch 6/50
 - 5s - loss: 0.1800 - acc: 0.9518 - val_loss: 0.1926 - val_acc: 0.9616
Epoch 7/50
 - 5s - loss: 0.1684 - acc: 0.9561 - val_loss: 0.1585 - val_acc: 0.9656
Epoch 8/50
 - 6s - loss: 0.1553 - acc: 0.9586 - val_loss: 0.1894 - val_acc: 0.9592
Epoch 9/50
 - 6s - loss: 0.1502 - acc: 0.9590 - val_loss: 0.1663 - val_acc: 0.9664
Epoch 00009: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 14s - loss: 0.3609 - acc: 0.9045 - val_loss: 0.2565 - val_acc: 0.9406
Epoch 2/50
 - 6s - loss: 0.2169 - acc: 0.9433 - val_loss: 0.3016 - val_acc: 0.9102
Epoch 3/50
 - 5s - loss: 0.1940 - acc: 0.9493 - val_loss: 0.1639 - val_acc: 0.9672
Epoch 4/50
 - 5s - loss: 0.1771 - acc: 0.9529 - val_loss: 0.1745 - val_acc: 0.9586
Epoch 5/50
 - 6s - loss: 0.1649 - acc: 0.9568 - val_loss: 0.1853 - val_acc: 0.9560
Epoch 6/50
 - 6s - loss: 0.1518 - acc: 0.9596 - val_loss: 0.1805 - val_acc: 0.9608
Epoch 7/50
 - 6s - loss: 0.1451 - acc: 0.9609 - val_loss: 0.2300 - val_acc: 0.9602
Epoch 00007: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 15s - loss: 0.3590 - acc: 0.9115 - val_loss: 0.3068 - val_acc: 0.9312
Epoch 2/50
 - 6s - loss: 0.2251 - acc: 0.9366 - val_loss: 0.1663 - val_acc: 0.9614
Epoch 3/50
 - 6s - loss: 0.1994 - acc: 0.9444 - val_loss: 0.1990 - val_acc: 0.9570
Epoch 4/50
 - 6s - loss: 0.1808 - acc: 0.9529 - val_loss: 0.1990 - val_acc: 0.9436
Epoch 5/50
 - 6s - loss: 0.1650 - acc: 0.9556 - val_loss: 0.9883 - val_acc: 0.7720
Epoch 6/50
 - 6s - loss: 0.1552 - acc: 0.9578 - val_loss: 0.3251 - val_acc: 0.9096
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 15s - loss: 0.3661 - acc: 0.9060 - val_loss: 0.3010 - val_acc: 0.9416
Epoch 2/50
 - 6s - loss: 0.2259 - acc: 0.9386 - val_loss: 0.1549 - val_acc: 0.9646
Epoch 3/50
 - 6s - loss: 0.2011 - acc: 0.9449 - val_loss: 0.1748 - val_acc: 0.9598
Epoch 4/50
 - 6s - loss: 0.1910 - acc: 0.9470 - val_loss: 0.2503 - val_acc: 0.9614
Epoch 5/50
 - 6s - loss: 0.1733 - acc: 0.9528 - val_loss: 0.1972 - val_acc: 0.9464
Epoch 6/50
 - 6s - loss: 0.1514 - acc: 0.9615 - val_loss: 0.1677 - val_acc: 0.9594
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 15s - loss: 0.3638 - acc: 0.9048 - val_loss: 0.2354 - val_acc: 0.9542
Epoch 2/50
 - 6s - loss: 0.2205 - acc: 0.9386 - val_loss: 0.1854 - val_acc: 0.9606
Epoch 3/50
 - 6s - loss: 0.2021 - acc: 0.9429 - val_loss: 0.1873 - val_acc: 0.9528
Epoch 4/50
 - 6s - loss: 0.1875 - acc: 0.9500 - val_loss: 0.1574 - val_acc: 0.9614
Epoch 5/50
 - 6s - loss: 0.1638 - acc: 0.9554 - val_loss: 0.4685 - val_acc: 0.9004
Epoch 6/50
 - 6s - loss: 0.1573 - acc: 0.9580 - val_loss: 0.2020 - val_acc: 0.9628
Epoch 7/50
 - 6s - loss: 0.1508 - acc: 0.9591 - val_loss: 0.1605 - val_acc: 0.9614
Epoch 8/50
 - 6s - loss: 0.1433 - acc: 0.9623 - val_loss: 0.1369 - val_acc: 0.9668
Epoch 9/50
 - 6s - loss: 0.1337 - acc: 0.9658 - val_loss: 0.1587 - val_acc: 0.9658
Epoch 10/50
 - 6s - loss: 0.1363 - acc: 0.9662 - val_loss: 0.1224 - val_acc: 0.9708
Epoch 11/50
 - 6s - loss: 0.1349 - acc: 0.9638 - val_loss: 0.1612 - val_acc: 0.9582
Epoch 12/50
 - 6s - loss: 0.1279 - acc: 0.9661 - val_loss: 0.2377 - val_acc: 0.9254
Epoch 00012: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 16s - loss: 0.3701 - acc: 0.9037 - val_loss: 0.2575 - val_acc: 0.9450
Epoch 2/50
 - 6s - loss: 0.2308 - acc: 0.9371 - val_loss: 0.2015 - val_acc: 0.9470
Epoch 3/50
 - 6s - loss: 0.2038 - acc: 0.9427 - val_loss: 0.2163 - val_acc: 0.9272
Epoch 4/50
 - 6s - loss: 0.1884 - acc: 0.9502 - val_loss: 0.2618 - val_acc: 0.9366
Epoch 5/50
 - 6s - loss: 0.1710 - acc: 0.9558 - val_loss: 0.2391 - val_acc: 0.9460
Epoch 6/50
 - 6s - loss: 0.1682 - acc: 0.9558 - val_loss: 0.2677 - val_acc: 0.9244
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 17s - loss: 0.3541 - acc: 0.9119 - val_loss: 0.1804 - val_acc: 0.9600
Epoch 2/50
 - 6s - loss: 0.2186 - acc: 0.9424 - val_loss: 0.2255 - val_acc: 0.9332
Epoch 3/50
 - 6s - loss: 0.1940 - acc: 0.9492 - val_loss: 0.2019 - val_acc: 0.9478
Epoch 4/50
 - 6s - loss: 0.1738 - acc: 0.9515 - val_loss: 0.2038 - val_acc: 0.9570
Epoch 5/50
 - 6s - loss: 0.1637 - acc: 0.9560 - val_loss: 0.1509 - val_acc: 0.9638
Epoch 6/50
 - 6s - loss: 0.1597 - acc: 0.9584 - val_loss: 0.1457 - val_acc: 0.9688
Epoch 7/50
 - 6s - loss: 0.1464 - acc: 0.9616 - val_loss: 0.1351 - val_acc: 0.9700
Epoch 8/50
 - 6s - loss: 0.1403 - acc: 0.9641 - val_loss: 0.1436 - val_acc: 0.9654
Epoch 9/50
 - 6s - loss: 0.1381 - acc: 0.9633 - val_loss: 0.1648 - val_acc: 0.9606
Epoch 00009: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 16s - loss: 0.3593 - acc: 0.9106 - val_loss: 0.2708 - val_acc: 0.9398
Epoch 2/50
 - 6s - loss: 0.2220 - acc: 0.9393 - val_loss: 0.1655 - val_acc: 0.9584
Epoch 3/50
 - 6s - loss: 0.1955 - acc: 0.9476 - val_loss: 0.1947 - val_acc: 0.9442
Epoch 4/50
 - 6s - loss: 0.1760 - acc: 0.9515 - val_loss: 0.1742 - val_acc: 0.9610
Epoch 5/50
 - 6s - loss: 0.1674 - acc: 0.9555 - val_loss: 0.1503 - val_acc: 0.9650
Epoch 6/50
 - 6s - loss: 0.1578 - acc: 0.9598 - val_loss: 0.2069 - val_acc: 0.9580
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 17s - loss: 0.3625 - acc: 0.9102 - val_loss: 0.2051 - val_acc: 0.9554
Epoch 2/50
 - 6s - loss: 0.2189 - acc: 0.9425 - val_loss: 0.1693 - val_acc: 0.9598
Epoch 3/50
 - 6s - loss: 0.1885 - acc: 0.9494 - val_loss: 0.1913 - val_acc: 0.9596
Epoch 4/50
 - 6s - loss: 0.1739 - acc: 0.9527 - val_loss: 0.2064 - val_acc: 0.9562
Epoch 5/50
 - 6s - loss: 0.1706 - acc: 0.9546 - val_loss: 0.1647 - val_acc: 0.9660
Epoch 6/50
 - 6s - loss: 0.1593 - acc: 0.9574 - val_loss: 0.1793 - val_acc: 0.9612
Epoch 00006: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 17s - loss: 0.3667 - acc: 0.9058 - val_loss: 0.2159 - val_acc: 0.9484
Epoch 2/50
 - 6s - loss: 0.2184 - acc: 0.9427 - val_loss: 0.1891 - val_acc: 0.9594
Epoch 3/50
 - 6s - loss: 0.1980 - acc: 0.9448 - val_loss: 0.2049 - val_acc: 0.9514
Epoch 4/50
 - 6s - loss: 0.1718 - acc: 0.9562 - val_loss: 0.1663 - val_acc: 0.9590
Epoch 5/50
 - 6s - loss: 0.1634 - acc: 0.9575 - val_loss: 0.2679 - val_acc: 0.9064
Epoch 6/50
 - 6s - loss: 0.1546 - acc: 0.9587 - val_loss: 0.1978 - val_acc: 0.9532
Epoch 7/50
 - 6s - loss: 0.1526 - acc: 0.9606 - val_loss: 0.2424 - val_acc: 0.9562
Epoch 8/50
 - 6s - loss: 0.1491 - acc: 0.9620 - val_loss: 0.1341 - val_acc: 0.9736
Epoch 9/50
 - 6s - loss: 0.1421 - acc: 0.9630 - val_loss: 0.1430 - val_acc: 0.9656
Epoch 10/50
 - 6s - loss: 0.1372 - acc: 0.9646 - val_loss: 0.1347 - val_acc: 0.9718
Epoch 11/50
 - 6s - loss: 0.1291 - acc: 0.9663 - val_loss: 0.2554 - val_acc: 0.9334
Epoch 12/50
 - 6s - loss: 0.1315 - acc: 0.9649 - val_loss: 0.1328 - val_acc: 0.9640
Epoch 00012: early stopping
Train on 10252 samples, validate on 5000 samples
Epoch 1/50
 - 18s - loss: 0.3617 - acc: 0.9070 - val_loss: 0.2538 - val_acc: 0.9296
Epoch 2/50
 - 6s - loss: 0.2142 - acc: 0.9427 - val_loss: 0.2776 - val_acc: 0.9248
Epoch 3/50
 - 6s - loss: 0.1891 - acc: 0.9486 - val_loss: 0.1800 - val_acc: 0.9562
Epoch 4/50
 - 6s - loss: 0.1811 - acc: 0.9521 - val_loss: 0.1476 - val_acc: 0.9668
Epoch 5/50
 - 6s - loss: 0.1656 - acc: 0.9555 - val_loss: 0.1692 - val_acc: 0.9604
Epoch 6/50
 - 6s - loss: 0.1621 - acc: 0.9559 - val_loss: 0.1789 - val_acc: 0.9630
Epoch 7/50
 - 6s - loss: 0.1537 - acc: 0.9606 - val_loss: 0.1306 - val_acc: 0.9676
Epoch 8/50
 - 6s - loss: 0.1485 - acc: 0.9615 - val_loss: 0.1831 - val_acc: 0.9614
/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=64, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=16, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=4, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=32, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=8, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
/home/lab307/PycharmProjects/ECG/model/attention_model.py:136: UserWarning: Update your `Conv1D` call to the Keras 2 API: `Conv1D(filters=128, padding="same", kernel_size=3, activation="relu", strides=2)`
  strides=2, padding='same', activation='relu')(input_name_list[0])
Epoch 00008: early stopping
Traceback (most recent call last):
  File "find_offset.py", line 52, in <module>
    wave()
  File "/home/lab307/PycharmProjects/ECG/model/attention_wave.py", line 196, in wave
    attention_experiment(para_dict)
  File "/home/lab307/PycharmProjects/ECG/model/attention_wave.py", line 176, in attention_experiment
    data = out_data(read_path=read_path)
  File "/home/lab307/PycharmProjects/ECG/model/load_data.py", line 20, in out_data
    x_train, y_train = read_data(train_path, 5, switch=switch)
  File "/home/lab307/PycharmProjects/ECG/model/load_data.py", line 45, in read_data
    file_list = os.listdir(path)
FileNotFoundError: [Errno 2] No such file or directory: '../beat/train/'
Job end!
